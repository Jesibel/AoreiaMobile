<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=2" />
    <title>AOREIA MOBILE</title>
    <meta charset="utf-8">
       
  <title>Validacion de usuarios</title>
  <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.css" />
  <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
  <script src="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.js"></script>
		<!--script>document.location='http://test.aoreia.com';</script-->
</head>
<body>
<div data-role="page" id="inicio" style="background:#D1ECF4;" >
	
      <div data-role="header" role="banner" class="ui-header ui-bar-inherit" style="background:#D1ECF4;">
		
		<h1 class="ui-title" style="padding:0px;" role="heading" aria-level="1">
		<img style="height:150px;width:230px;" src=" http://test.aoreia.com/resources/img/logo_aoreia.png"></h1>
		<h1 style="color:#0057A6"> American`s Online Real Estate </h1>
		<h1 style="color:#0057A6">    Investors Association      </h1>
	</div>
	
	  <div style="background:#EC6C00"><center>HOME</center></div>
	
	
	<div data-role="content" >	
		<form id="loginForm">
			<table>
				<tr>
					<td><label> E-mail Address: </label></td>
					<td><input type="text" id="loginEmail" name="loginEmail"></td>
				</tr>
				<tr>
					<td><label> Password: </label></td>
					<td><input type="password" id="loginPass" name="loginPass" ></td>			                  
					<!--a class="textsize10 textbold" style="color:#333 !important;" href="forgotPassword.php">Forgot Password?</a-->
				</tr>
				<tr>
					<td colspan="2"><input type="button" value="Login" id="sendButton" ></td>
				</tr>
				<tr>
					<td colspan="2"><input id="forgotHtml" class="excecute" type="button" data-title="FORGOT YOUR PASSWORD" data-src=" http://test.aoreia.com/forgotPassword.php" data-excecute="forgotPassword" onclick="window.location.href='#forgotHtml'" value="Forgot your PassWord" data-theme="b"></td>
				</tr>
			</table>	
    	</form>	
		
		
			
		
		
	</div>
	
	<div id="both" data-role="popup" data-transition="slideup" data-theme="a" class="ui-content">
		<p></p>
	</div>

</div>
	
<div data-role="page" id="home" style="background:#D1ECF4;">
		
	<div data-role="header" role="banner" class="ui-header ui-bar-inherit" style="background:#D1ECF4;">
		<h1 class="ui-title" style="padding:0px;" role="heading" aria-level="1">
		<img style="height:150px;width:230px;" src=" http://test.aoreia.com/resources/img/logo_aoreia.png"></h1>
		<h1 style="color:#0057A6"> American`s Online Real Estate </h1>
		<h1 style="color:#0057A6">    Investors Association      </h1>
	</div>
	
	<div style="background:#EC6C00"><center>HOME</center></div>
	  
			 
	<div data-role="content">	
		<!--h2> Welcome Aoreia Mobile </h2>
		<h3> Your username and password are valid</h3-->
		<iframe id="homeHtml" class="iframeRender" style="height: 759px; width:1500px;" src=" http://test.aoreia.com/homeinside.php">
			<html>
				<head></head>
				<body></body>
			</html>
		</iframe>
	</div>
 
</div>

<div id="forgotHtml" data-role="page" data-url="forgotHtml">
	<a class="toMainMenu" style="display:none;" href="#principalMenu"></a>
	
	<div data-role="header" role="banner" class="ui-header ui-bar-inherit" style="background:#D1ECF4;">
		
		<h1 class="ui-title" style="padding:0px;" role="heading" aria-level="1">
		<img style="height:150px;width:230px;" src="http://test.aoreia.com/resources/img/logo_aoreia.png"></h1>
		<h1 style="color:#0057A6"> American`s Online Real Estate </h1>
		<h1 style="color:#0057A6">    Investors Association      </h1>
	</div>
	
	<div class="ui-content" style="padding: 0px;" role="main">
		<iframe id="pageHtml" class="iframeRender" style="height: 759px; width:1500px;" src="http://test.aoreia.com/forgotPassword.php">
			<html>
				<head></head>
				<body></body>
			</html>
		</iframe>
	</div>
	
</div>

<script type="text/javascript">
//$('#pageHtml').attr('src','http://test.aoreia.com/forgotPassword.php');

//$('#homeHtml').attr('src','http://test.aoreia.com/homeinside.php');
</script>

<script type="text/javascript">
	//menuClick('menu-home');

	$(document).ready(function () {
		
		
    	$('#sendButton').bind('click', function (e) {
		
		var posY = e.clientY+e.currentTarget.clientHeight;	
        		
				if  ($('#loginEmail').val().length == ""){
					   $("#both p")
						.text("Empty Fields")
						.parent().popup( "open", { y: posY } );
					   return false;
					   
				}
				
				if  ($('#loginPass').val().length == ""){
					   $("#both p")
						.text("Empty Password")
						.parent().popup( "open", { y: posY } );
					   return false;
					   
				}
					  
									
				$.ajax({
					type: 'POST',
				    dataType: "json",
					url: 'http://test.aoreia.com/resources/php/loginverify.php',
					data: 'loginEmail=' + $('#loginEmail').val() + '&loginPass=' + $('#loginPass').val(),
					success:function(msj){
						//alert(msj.success+"|"+msj.error);							
						if ( msj.success ){
							
							//otro ajax
							$.ajax({
								type: 'POST',
								dataType: "json",
								url: 'http://test.aoreia.com/properties_validacion.php',
								data: 'loginEmail=' + $('#loginEmail').val() + '&loginPass=' + $('#loginPass').val(),
								success:function(msj){
									//alert(msj.success+"|"+msj.error);							
									if ( msj.success ){
									
									$.mobile.changePage("#home")
									//alert('aqui');
									
									}
									else{
										
									}
								},
								error:function(){
									
								}
							});	
						
						
						}
						else{
							
						}
					},
					error:function(){
						
					}
				});		
							
		});//$('#sendButton').bind('click', function ()
		
       
    });
	
</script>
	
<script>
 
$('#formulario').submit(function() { 
	
	 
	// recolecta los valores que inserto el usuario
	var datosUsuario = $("#emailaddress").val()
	var datosPassword = $("#password").val()
	
  	archivoValidacion = "validation_data.php?jsoncallback=?"
	//archivoValidacion = "http://revolucion.mobi/ejemplos/phonegap/envioFormulario/validacion_de_datos.php?jsoncallback=?"
 
	$.getJSON( archivoValidacion, { usuario:datosUsuario ,password:datosPassword})
	.done(function(respuestaServer) {
		
		alert(respuestaServer.mensaje + "\nGenerado en: " + respuestaServer.hora + "\n" +respuestaServer.generador)
		
		if(respuestaServer.validacion == "ok"){
		  
		 	/// si la validacion es correcta, muestra la pantalla "home"
			$.mobile.changePage("#home")
		  
		}else{
		  
		  /// ejecutar una conducta cuando la validacion falla
		}
  
	})
	return false;
})
	
</script>

</body>
</html>

